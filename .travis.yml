dist: bionic

language: generic

cache:
  pip: false
  directories:
  - "$HOME/db/"
env:
  global:
  - GIT_NAME: Spirillen
  - GIT_EMAIL: 44526987+spirillen@users.noreply.github.com
  - TRAVIS_REPO_SLUG: "${TRAVIS_REPO_SLUG}"
  - GIT_BRANCH: "${TRAVIS_BRANCH}"
  - TZ: UTC
  - PYTHON_VERSION: 3.8.5
  - SCRIPT_SOURCE_URI: https://raw.githubusercontent.com/dns-test/script-hub/master
  - Pyfunceble_version: PyFunceble@raw2sqlalchemy
  - PYFUNCEBLE_CONFIG_DIR: "${TRAVIS_BUILD_DIR}/.pyfunceble/"
  - PYFUNCEBLE_OUTPUT_LOCATION: "${TRAVIS_BUILD_DIR}/.pyfunceble/"
  - PYFUNCEBLE_AUTO_CONFIGURATION: true
  - PYFUNCEBLE_DB_CHARSET="${DB_CHARSET}"
  - PYFUNCEBLE_DB_HOST="${DB_HOST}"
  - PYFUNCEBLE_DB_NAME="${DB_NAME}"
  - PYFUNCEBLE_DB_USERNAME="${DB_USERNAME}"
  - PYFUNCEBLE_DB_PASSWORD="${DB_PASSWORD}"
  - PYFUNCEBLE_DB_PORT="${DB_PORT}"
  - secure: pcZaQc61pZcL3a/vQVTuMKb/vZ8w7+H1NNsRe/EB0IBGCSpDXIj++b6KVT/dNkkG/Jun4SgyBENEPoyZ+OJ/9R2tSG4CxCzKru+dt/uklfnbbQrKf7S20h6CeW7y1hDT7huHGZU/a5kAZzN5aR2waVskeO63h41TGsxO0cOLNAkBCBTGfiRL9HqIUn2HT5vKBCcnF1paP0C3qq+0Q6JjHWGFA3gSAYfWxMYBtzC11Onlu5qq4Dmm/W9LH0DFgoV76RzDIxrxkXiVHYg6Z7R61YGp+bF6u3f15l0Iik1Bh62Qm6hpW5Hw32uhWg9xRBB6quS6RCYiFrw+GjusZqhGlE0H+/C20C2xSnOvJ4/aDkOGa8xK+UpqXOcKvs/+/+ZnfijWP/lvCkunQr7bDaUwk3CHYbWqhK8Yxk6fLUZpZgJKPJlPbxGA7A5ubLxKdDFiiCJ/lRL2Uew6MhfGbWgBT7iqL+uzDjIZ6uJ5+cVDvT1pnWsUGyPxnmlIFYxwt8FZ1lm3ab4YGQIN71TxbjfhLfOCD3WaLWJpNi2Z2xjVnRavyw0zn0/GAYuvJnxlc29ZwrC0LerhN+mFgnLCvdUsuAKNAISpjxpva1WVxrq7cvIeCfV8meYjunfby6Ug6oinkDt154PF+5sLAElh6tl3VDTWmIiVE+I58QgAdQ9YeEc=
  - secure: hlE82D1mn898ojdsrNoIl//E+vDF76BMuSVGFFVkqX2JynIK46ZE4udDjF9+i5hB1Gg/bX2W5pB/63w9Cb66oKivBzgUSqEl53LgknRIaJnshzm0oLqV4sYPymZ3ku1D8vUQ6Wm8iPddKsv49govY9zjep+9sB6MbTqgeOtZa5xDglqi3gLAZ6FVdcrTbZ/bpUoJjnupzaX7HXyWVJyPEwOJLZrHKhPIq5TC0kJT3mkbe2OgVJ5JY3jmscxEaAZEruzQDSdty8Lp7BDzfWeUoME+7/6lBDLui1OhEGRnNlvUPKNgUEyW52Gy18BRNiZ3TshTDsdkYY2bdnwcDi7JvbPTD5C+sdoITLMfyXXd/cw4ZpAw/9ZAEKOJNFHSdSueLd4hvVZ2qy7v7Z2S8QACu4gwG6tOJjSIv0me9tUgsIm4CcEICxBZ/GEPVFM58std6/W+8OdZhlYZfroXH72G1WYtl9rbM/t2kwLuqZHwZMGBpH+8WanJKTCp5xB5fl6TWO+vQyzNNDBnU580BPu10dPC+XOhUvlCXOc/Ldycfu8Yd3elVtdpn0bOmuaQNJa4NabyMMuHIKS0VY5sh3ZUob4q8ac5XRU24Mjz2jfJy+/pj8btmcEPtyNtuWqgejU4a7ttdLjV989z+4o1soAtJarBbTwcMT5RKb3vUisI37Y=
  - secure: bLgrNbBgkNW7rxfzviRz+gjCKHQ0C0LhwBg+0R+ML5w1TgSek3ULkQXgs8qGvEuMnNogd0eP1euAfmvC6un+NtLJchsir+UMDEHHggLERB8SKoXAjG+zFVYLF2TVCQUjFyVossUtiWvH/KS3Vaig5Y7iuQ4BUooRKeweHkpwv1lFoUKf4ENowg5Yw8z4aBtL1u9/FdFvLi+VOWX3rBSQxQlQ11CQ5xjHjDculN6/neuzIyWlsLRRK0b8ImgOxcoE+TCZn7oodq1hwfyqgs/OfV5TSLMXQTiJ9BVTkx0XdyP6NSIlJFklLfhb3Dz0B2pfnDsvr2y3Omj/u/Cr3IqDonXSbJ8GnR1RH1uvnMFs0Y184th3maxMDQ/hDeoBQD4dldJW7XftYcsWTx61MDaam42JS+tBPoKlJt6P3h5MFux1IPrgEQQP1IC1HJS+SdAZryn6g5OXo7WCGljlr7d7AWscod+rkmxSuuu0iBGjCtgjmjOyE6yb5vQ8b0lefdOsgV9kJOadrlbXqTTADswPPPbsg/f1tPOEUqpmiX9gcC6+4bsn5MKx7S8Sk9LFC87TgwvqjD95OJyXrCAdxZ6wwLBVWS1wB7prtoBTWaNWwK0yH7TpzBsxPzkK8vMvk2Dw7HEh4P4uZTmY6iL81dEg1KX0xpIhJYBMRgYCc+vxnGY=
  - secure: qI+bwmFJITKWMP5nJfMCHDSIISAvo5Wz4W0C2/LMObO/wPoctwEsi5lJ+D0X0aIxu+3oG5q8kqcAnGe5anyPagZkYC8Gf6NVqdcP5fVoaTtMrDS9dsCWD1GWMyPod24Ji+4aHgURBPMcNHUho8oNgqAmDywYVVD26DWz5CnhLNcwzJgAPcfZPZLXEprOSzncnYbuEIvYym+rJDyc4Pr5INzGdtZhkNmbZn9eJFXk6cOB6BjHCKuALUUyENsrk+Cf265oW76e9Ijx27VRsUTAxHfbZaAfBX94hwDB2FjommNz5m62gCn9n5oB6zPnJ0P7ZGh/gb4bK1ZJXg8nEtIadL0mQvVSFEUl/BkiaptIjERQfcrd7PRpeSlnac4Z0PIjlKl4SIsNNpMtSnrBmleBPT0mDDXS2RP5d0Wf6nyR7/Nc17Mj2/DElvLCrXHQP+Ngu+X8+yF7y5Fr7C/lep6fWyWUj2e5Wqd8E03GSVT4dyjjpllDMraA6ZsmIcpES4EnNZe3NyLsUOvMkNrCUetCkJXAjndUs2zXJ24cXGXwrLUjOskJcZ/HuXPF9OFjW6pbXd2H0mRAbFEiYS/hWuq4L+8aEPYTXOtqP+ma9zrq7acHjL5No7nJKyzal0e9IJ+5kY7QUCIrXwyhDtehsm1e7QOcZ5/eoffIJTFRYLYcjks=
  - secure: MsV5Kk26whG1DZGbbccMMvZPROYEIzAmehUORHd/iYzp6D1shwMSh/kcEQukTwt1jaBUEhPk+PGM4fasq7+XEQKzgTk1V4P7/K2at0QBuknScXORe8NqfxlCL0bvnnCztm6nxcSRZ1PLUFXoeNACi5YyOQHaC2/DY0VcrxOOoc3mkMjAtsMrZ5B6uNIKhdRnHt6HkimStvVPHs7/VBIyhxBvY17YO8w3syTz7JYD4Iah3me6z4qx+4k5L+Ip56YNbwLual35XvFKF9h3kscJWBIX5z4ZGi5F3zm7+QHamuQGW4mJBs2JCGH5Tvav31fuNERSFE5Uu6ouMhYohzEgIiSKIll4arTKa/6rSwcy9XNyMPWLRTWQDMWnwbszuOHUtAcW4zAjZrHqtZHBmQZBMZqvmEQcnSSG0FUiwjYWMWJIXHm+iOhGTni/NIZgsc9sEW68Pnu0m69oQGkfBMJYhsRhWNOwIQY31evJK7JKK7U6TCKxHKZJ/twWkQf0HsMZAjzZrZaMQcIg1zNjkTw/Rx0h6i7JZ1XO8zPFCHhCpIcstVrFzvpJaFaWW4Iy9lHdxnwbrLp7XtgvCnZvfvXsPGghrfbw9AGt1UoBGl7DHMkcRA5dyq0sgowAK573s75KjQAu3iNLj1a0rrWhQ8IkyET3VDlyoppHj79EykkkJFI=
  - secure: RumhpjkGXuuTfAOw2b+l8iwIZPitTGbLu8trXI1xT+vQoZfaF+F2oCLDGxYr8eEWSv1bfCPFFnbzPVveEq/4RhhfdquwNIOeIzYgGummRXsVsTAIa9fn32gBELkJmmrl41DKO7EleQhFbOTts8Ujhy22l6qL6hfuJ+KmyGNKkx+AJPSaUNfZnzGj0sNBvm4Od2sHM6EtX18Op0pw1y16qy18N+5Q2MTeOBU1lDr5MfckrPnThpvZgIqycLFblUuq5J9ddUiHohm/ml2j5lGTjN5f8xZWJpWpY7PWVk872yVdSHtjVivBFvTmwKp55yA5yEmla8zyQF27z6zq1TVWYywTezyFvyXSDpb7QZcC6i1bwOdS+zXKyhfITV3RUt1wnufNOvp/T6Jrzf/94SOpUXv4OIymGASZ0cuI2OhiBq4P2wQVdFW/RVYIVaVc9FPsvU5Li1BfuElwVde8rJdU29lXKdk/3IQGDc4d6ETezXiycIRHzm1nbC41OB1t7ajpJEpJZ3iQOxD6YR35rih/b7JxDMsmpfHx0HtqVgjSwKDfebEQX1FdGB4JGVFk2XCsPVsZVJrAOxRkW+tYw8oOzGSxMdVePaVq4eCgkQdZMC8a/1+wBEmrXORPN4nOp0aC/rSt4+GK+tYeIOlSFDeOSiOOLuTc2fjrs7Qfp2k989g=
  - secure: n10uGx66MSNo6u0Q2RDLfQmYBNcfPqRPMM3ekV+MFzQIFJi7gDFIXQLFYoawzF+4MYMWOeNwnLMigDkISTO70UjbaLccKHvQV+erBEO+6x5hECTKqxO7IAgEeA5uqOEETIIE0lc8A7mvSLCm2luj/5obuVn6XpsC2Wz/JCEMDtfdNDChJ7HbdWDP8GeoqkiKB6PcpC4FpZekd7Zq9hMYp3q9WvJzcyaqlCjDFq7VK0qjGNgCqMtLK3iqiYnRz4cqiyZCidrOd/JYiSvdMiFLkfzkU5kT/IRPwjoQSWzpLXsjbH5JIzrz8blIevPwkvnQtjos2IghU0NgmsVaYM6jGI9BOSgOgs2G7NML8fL062zZ/yjtBNuxufyH6lxeExXqynXsJfgjWc+yzPHj1HNfWDi0WWdRKwyl3kFraZ1AeGVgDe7HIhwL9IQMghIvXeoqo40Z6YunWgIZVeLxd8x5eSSfysk2CHDwDZQAswfTMTJfrlJODvKtYpTmdkMKe3IcpCIcS4jocTMjwvxErXkCyM8VOF1HhdQ2Zx2x32+C0cN+yirnsvc03ynJItmdmD08eJu9bBefPPn/jccTWrDtDnL3C/wSLrIjXxFR4gp44+JSzt9J1Nmtgqn8eSkhv+72Tu2RGxA4hLC6j3VIublZO+lIf1sQ5WdTOOvjcrBAv74=

# We needs the mariadb client...
#addons:
#  mariadb: '10.5'

install:
- export PATH="${HOME}/miniconda/bin:${PATH}"
- if [[ "${TRAVIS_OS_NAME}" == "osx" ]]; then wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh
  -O miniconda.sh; else wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
  -O miniconda.sh; fi
- bash miniconda.sh -b -p ${HOME}/miniconda
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda config --add channels conda-forge
- conda update -q conda
- conda create -q -n test-environment python="${PYTHON_VERSION}"
- source activate test-environment
- python --version --version
- pip --version
- conda --version
- pip install --no-cache-dir -U dnspython[dnssec,idna]
- pip install --no-cache-dir -U "git+https://github.com/funilrys/${Pyfunceble_version}"
- pyfunceble --version
- wget -O "${TRAVIS_BUILD_DIR}/setup_travis.sh" "${SCRIPT_SOURCE_URI}/travis/setup_travis.sh"
  && sudo chmod +x "${TRAVIS_BUILD_DIR}/setup_travis.sh"
- sudo bash "${TRAVIS_BUILD_DIR}/setup_travis.sh"
git:
  depth: 2

script:
- truncate -s 0 "${TRAVIS_BUILD_DIR}/run_id"
- echo "${TRAVIS_JOB_ID}" > "${TRAVIS_BUILD_DIR}/run_id"
- cat "${TRAVIS_BUILD_DIR}/run_id"
- bash "${TRAVIS_BUILD_DIR}/dns-test.sh"
