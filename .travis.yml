dist: bionic

language: generic

cache:
  pip: false
  directories:
  - "$HOME/db/"
env:
  global:
  - GIT_NAME: Spirillen
  - GIT_EMAIL: 44526987+spirillen@users.noreply.github.com
  - TRAVIS_REPO_SLUG: "${TRAVIS_REPO_SLUG}"
  - GIT_BRANCH: "${TRAVIS_BRANCH}"
  - TZ: UTC
  - PYTHON_VERSION: 3.8.5
  - SCRIPT_SOURCE_URI: https://raw.githubusercontent.com/dns-test/script-hub/master
  - Pyfunceble_version: PyFunceble@raw2sqlalchemy
  - PYFUNCEBLE_CONFIG_DIR: "${TRAVIS_BUILD_DIR}/.pyfunceble/"
  - PYFUNCEBLE_OUTPUT_LOCATION: "${TRAVIS_BUILD_DIR}/.pyfunceble/"
  - PYFUNCEBLE_AUTO_CONFIGURATION: true
    #- PYFUNCEBLE_DB_CHARSET="${DB_CHARSET}"
  #- PYFUNCEBLE_DB_HOST="${DB_HOST}"
  #- PYFUNCEBLE_DB_NAME="${DB_NAME}"
  #- PYFUNCEBLE_DB_USERNAME="${DB_USERNAME}"
  #- PYFUNCEBLE_DB_PASSWORD="${DB_PASSWORD}"
  #- PYFUNCEBLE_DB_PORT="${DB_PORT}"
  - secure: "WpqeZNTnJdE9P/GaNftQryLVC2jSc95Ny0E28c/4vFimAcRYA0Tch6j+EVLVa/0shFoxlCQRmsMLiG40mSZup70M4eJwCWTqVDcQ/rVj73XOuQOM/sTT5XNI607JXoCGdBI2Yar7dgnMqGqboeuUM+4oz1PitWQQDE4z6zcDLmWcM3VSaDrKtNrd0rh266QEjPEw0Q+za1Ciym51xnY1TuBfL8y5rekALbXk29KK/RAyuMMyKixoVbmViEY1FpRFV/MjLwxHSU1BZ6ubfycBqu9ZUMqsX/wGJV9G/fFJYAKaLx4+scKlnbwMGGn6i4Rm/UwE/y8YDaLjBKm63Ti1czL1AX+CTv7+Jrub9YSwwfGgSmVbFiyhTBEocVf8w12Aqr3qKs6IOlmqw6bmrFGYTPiU13umCeFzqYOiGzXRR975Lv6PC906Ea1V4UjkRyGtj2QdtV4RQyR0RZDAXF4j8Ismv1luHo5oY60FVBrzS4CKHXZAAAjOJZlPZrMQFrEYSy1MRcETW5jPzhCeC3VrRry+A/CirCCHFGQdYpFyXw8fj6RQNo43lev7xlWqYfDOsKjiaplX9QjGU7rAGKaPHM2bIaYCnf+yDvqMhIumvb/eAVMnO7c9TzaXZrtqMvLR2HjKC7aRuEAvVOjahqITE9mUvHzcuQZ/JtLKeEK9PTk="
  - secure: "hK/QtuE0BG5p8LEGjzrP43ji7txIdWmLIL94z6b6/EZgabxlXM9P2XK+lDJ/WNooL96GTLrbFgPfaYfkohqdrxcIiadcR+jRM8Uk/FIJ9QQqujiunfJaV8C9mQqbFZAuQeS0/mbFOUFaThpUjG3Ezc4cYQql78U1CyS/YcY8jw5Wci7vqk2l7sxdAo/laMk1suHAhv+DHUQs0z181NKgenfeZXcNYR1dDrPwZLfsRob+MiKt52t+O9PxWeTxGXfmCwEMCBlBolnsf0JDwY1VFUNsCh8A9Jofz+VfAqZt9s5ZeQ8WZnSGeNhb9elpHXDk7iewOzCSI1yhb6QeVoz40nWHv69FX368Ha/0iDmFryC/a5RZ/mOe2P/v1cYJrOtSBh5G4/Z1CqNDTCJMQ1tKkz6Ph4iU7OeqqFCzV5DMAjHyEt98W68NK7nEW2SlXDJgRPFk4tyCNOg89/CXSiidKq6uN4nvLYBfgxQDjUUJa8nX8dH9iBKTYkP1CQVBxgPFKc8l4zQxv9FBluE7rVpgma7W9sOiAw6jiDlfraaTLfQyzb8YAKxEN+On3VwFzW1kL7sqWIuT3t8OksDSd0BOI6u9Bl7fu3ZB+bH6Hko8yzioah8hROfWKT4ExZXN3EDZDLMP/VbyTfYhO2Kd5WH9df4Ey35mLTmK7KZP9jCsN60="
  - secure: "Ujhy2sNLaAYQOBf4PNTBS0SdU0kwufzq5Ap0XOpLUpdZy12YiM6X5SsGuAK/Pq85U3Qut4kTt5VdOCFA93+EACbOLLP6u+hlO265LzDwSNP4KwyNYRENX45WPth7idDhyW3kfHweCXY1OARaJNTUzhDvp/Ds6HUhL7XAi12Fe58OXqDQ9pB9rB5XIky/5ptDBFvr9k/pWhbA7G/KYpLO0SghWo2zaAtUxIc7taB3yQO7DBdvSZcxUUhyDyinmajpPHYj2M8TdqUjbnebpD+hfX9A5aJfiELaM5Eru9D10enk1fL+Gma5VJ2T2TkH/AEjX5CbnBVozSMcU1hXtUp1BiAGoUGnF4L+rb7CZjkuH8T9x0V2MUV96Yfwv4U/sUYT8NcU20bgECmqTF3gabDbDumrAJcUVTZscJimohLBrC+n6Zi05YkCG5wikk23gSYKaDPBeHH1rgTQ9Kl84HBihCzgckrnhbs7jF7aGpGDslCLNQq66D0tYy7lwVSNyK0+UgD7KTH7qTWtYRLjHwBHNatV+0PcOGh2ZOBgUgd0WEVuMlXtJMI8SbHsIiQqZAVOQe+r32uMXaB1+dB5BvFPd8tYQ6yhiKPsrSnd7HDEdZVjmeix6VAufYoS21/fRCp81eciRkKUe6Sw8AwCt1Zq7pT/6P11luU6EBPCPnRIjJk="
  - secure: "gz+nAgIDn2XIlayyteSysTnz4yBqtLIhwKf0fHDdf9PJsQwGsVoofCVWbrRErYvBxawqA0djp4jQfZ61h4IB8Him5k8FztDvFyoIExuSDjjsGgW0fHRXNz9N5YXksAus7yHthQxAHnLzXq74lZ8Mu1cc19FoBgS0WzRofUN9dLCsudJzgBLBf8TfvhJyPADBWG/dwURzgwoFVXYgoS5UCfaMs6K3n6WHwp8nmnP309V8CH8vwSr94Xu9ydOMqCpm7ms25kF7TfB/jULjSGHqnplk7Q5YYWjgcQ6K7j56yz+6gvojkYldacM2tgAA4XEChS4It11/KNS911lhOLE1rYrIkAjB9+/8DZ1NpXaQtq6gkQ1d9aJTCjmd3rNV36bJr7wzZ5qmU/UObdrB8pksgVJEtD5uLLcehcYS7p2fpqegfwE2yIJMsa9Vp6wDBTQ812ku91JDWEm0ykmIW2nN8ot7uVnT5wvTp9jakkJ/gcVV35lct5Br9fwaj2OeYe24hcr5TcpMS8C2a3X25gvK8TOUpzXL8aLQS2V7bsagXLbsZqcfjot8z1t2uwVSeF03Iv0Ed30Do8LNdSsChFFDvVrQWeiRQMiUaHm6bxoL2tP6paBSTmrlvT1j/I7QEUQ321io0YzSvbs+PE7aT8n0okhzlhnfegDOzWL+dSGEGwc="
  - secure: "PzJXYAjfLBkIPdoFbfmAxi12FkV1c0wahF2VZF758PqfREqUNDmnAe1xxMEbUr9RfH6AHaDQTawjdY9wo8+EeOOQq9TvoF5uA3Tj45vacreGcQqOZWjVSldbI09zqfVJ1kmea9WeqF4nrkbMPnFD3szhMWob8Q0rKDVCY+QmSA81BapR+uWu5C0mYLw3Kv2LWDkon6/xGVqDdau7f0M2TLgxrBOUhY/dwQvU937DEMzCRHccKS87WxNM5Axn51ZSzwDymaAZiWkJBiEPeNSyFVjtJ+euO4vkGPcDiZlcpQmadyz7KCc41qy3twbsoJZBY5HCTaiQSNuRkbHahXtlym+47b5/pBszlSsh0yqRAc1udktgUHol63zMW+o/UVZegpeIl2u7hwoXhZ/EdzeFAVwFJXllSADC+/dagYWUGSykFp6y7EpBMpz9XZJMMWH3yCjrbM4Xum0OkaSD/nvinb9ApSPuuj7hLZEHW/SwpbAbkvS1tm1r+3lcW2Y//KhfOqm2/+ip7MXItohuzOpUexRohi0f3RigmiZwloMqWJb731I3mfdKwA7vYLrocGpvDMijtBgkjK0x4NS2CHMd11piIVVLWSF7GKT1qp0SIYSSkKHYAQq9WCOsbI/ewRLdy9pH894wHzzgbGPeMfYLBL3tsoOuIvlL3aiEgeemSyo="
  - secure: "oJqWwTyhWOpCu+a6oe28o5UsE5e2sewdJoch9SJw4r/frYyUcu8ZG1FNmKurx+b1LkVv6SpYCLdlNJ0eyZROilCYVcclDmtN8h7egBFi2IiYJSTn/YcPNx96uGE5kcaOWBOL6489c1X2Jc37w0wvTsHFSxwcgYDRiuyEtwFgXHNgdrxpC5hjLr5Pp6z3uRvIY3yUbQQ4sdRZ73NSv43toVE+eTiZx21IxbCA7BdJezPTLmkSYUsfBLjPfs6RgLOkCpfixDaWQQaCNnR9O3tz1bKKcIb+7pIV9PMHCorE57XWInRPKTROU/+padP+lFsqnXotBrUyWYhW5jer48QnUWk9jWNwBYJHWCiAC41ZTlBcR9hvPz7Kv10g2MOmyIeIvMEVqIw/Z5f8o86bh8U9Ldh3ITscl6CcWzGzqZmbDjYsV0XP8t3OCM6ImXEZOlAsxaFixYzpC3D2uVumqbi0uu8NK2yNgKhXUu6EaPwIpM5WLlCCD6wrX3KB6MYcCf1df7i3Lo4m77mCdc7imcn4VEFht1GeuAo3Rm539+qc8m3dTY9ZENi0phGgyqwxYFsU8rWSxFGEkBMLOkrEb423fgK5mj53pFTTPBAmxHtz6VNxd+TpKTbZELiLWJiwfnotQJo4DJaIBPCFShLSS9sfCI98Z2TjsjJR/852sRGHkfk="
  - secure: "WV2zzzjW8VSyCNxJEF0JHbooBRQoJL1rBvBzD8CUHUp7AHAUXWuTeuuussPm9PsZ6k/KYSEVsRmhZNDVxcUOk/cCIlaU9ILK8wQZwwFwoX8IV93WSaeHVtsahnC3iwKL8LATFJVMBXrOOZVwMUQAfYNZ8jzj30rXvYOo5F6EPasGZLEqwaHbtyIBGdDYi8GgtsyNLG2V17DfFuPG6lN5Q2G6F2MWLLge/pWVUrnMAOPXmTUZ4rJivWQVtih3zLiosskehy24Oup6FkedjcWkCCmDDTf0rFxEOW21V1fG+Y+W96GzOcHg+qVjuMgZjczqunLmr0ZWnoj7mNXqcTufzqXy8TZDWWggxovgoPwwijnXm/93gLlo6BhfaQmr2QW5BbGXbKQZiPzHtqMkYym125P0ALo1KsLw9k3HVXuctbAAClQscc7r11rXEbDZa1iU9fik2IIKs0ZsmvSpaeZPISidJeJoUyyrQUc/pWQZgGenzvSysBEkRrrP9v+RUDPR93bEPD2qHdKUtKGsspR/2x6BNuG+Hy8zMYEI1AYeZLnowOUhB2BafZnuQ/uPh6QQzKx4JNZwc5kjMHUA/fdxiFwxc8IkWQVzg/My3OoY+HoPNXLSETF10vs9j3Q50sK+feqTcFMNDyGt/xvCnpPRyAlw3OHqZS2UssEpFB+Gbvk="

# We needs the mariadb client...
#addons:
#  mariadb: '10.5'

install:
- export PATH="${HOME}/miniconda/bin:${PATH}"
- if [[ "${TRAVIS_OS_NAME}" == "osx" ]]; then wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh
  -O miniconda.sh; else wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
  -O miniconda.sh; fi
- bash miniconda.sh -b -p ${HOME}/miniconda
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda config --add channels conda-forge
- conda update -q conda
- conda create -q -n test-environment python="${PYTHON_VERSION}"
- source activate test-environment
- python --version --version
- pip --version
- conda --version
- pip install --no-cache-dir -U dnspython[dnssec,idna]
- pip install --no-cache-dir -U "git+https://github.com/funilrys/${Pyfunceble_version}"
- pyfunceble --version
- wget -O "${TRAVIS_BUILD_DIR}/setup_travis.sh" "${SCRIPT_SOURCE_URI}/travis/setup_travis.sh"
  && sudo chmod +x "${TRAVIS_BUILD_DIR}/setup_travis.sh"
- sudo bash "${TRAVIS_BUILD_DIR}/setup_travis.sh"
git:
  depth: 2

script:
- truncate -s 0 "${TRAVIS_BUILD_DIR}/run_id"
- echo "${TRAVIS_JOB_ID}" > "${TRAVIS_BUILD_DIR}/run_id"
- cat "${TRAVIS_BUILD_DIR}/run_id"
- bash "${TRAVIS_BUILD_DIR}/dns-test.sh"
